(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(7052)}])},7052:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var n=t(5893),s=t(7294);t(1163);let i="/api";function c(e){let{onLogin:a,switchToRegister:t}=e,[c,l]=(0,s.useState)("acme@company.com"),[r,o]=(0,s.useState)("password"),[d,u]=(0,s.useState)(""),[h,m]=(0,s.useState)(!1),x=async e=>{e.preventDefault(),m(!0),u("");try{let e=await fetch("".concat(i,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c,password:r})}),t=await e.json();e.ok?(localStorage.setItem("token",t.token),a(t.token,t.company)):u(t.error||"Login failed")}catch(e){u("Connection error. Please try again.")}m(!1)};return(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h2",{style:{marginBottom:"24px",textAlign:"center"},children:"Company Login"}),(0,n.jsxs)("form",{onSubmit:x,children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Email"}),(0,n.jsx)("input",{type:"email",value:c,onChange:e=>l(e.target.value),required:!0,disabled:h})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Password"}),(0,n.jsx)("input",{type:"password",value:r,onChange:e=>o(e.target.value),required:!0,disabled:h})]}),(0,n.jsx)("button",{type:"submit",className:"btn",style:{width:"100%"},disabled:h,children:h?"Signing In...":"Sign In"}),d&&(0,n.jsx)("div",{className:"error",children:d}),(0,n.jsxs)("div",{className:"small",children:[(0,n.jsx)("strong",{children:"Demo companies:"}),(0,n.jsx)("br",{}),"• Acme Corp: acme@company.com / password",(0,n.jsx)("br",{}),"• TechStart Inc: admin@techstart.com / password",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Don't have an account?"," ",(0,n.jsx)("button",{type:"button",className:"link-button",onClick:t,children:"Create one here"})]})]})]})}function l(e){let{onRegister:a,switchToLogin:t}=e,[c,l]=(0,s.useState)(""),[r,o]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),[x,j]=(0,s.useState)(""),[v,p]=(0,s.useState)(!1),g=async e=>{if(e.preventDefault(),j(""),!c||!r||!d||!h){j("Please fill in all fields");return}if(d!==h){j("Passwords do not match");return}p(!0);try{let e=await fetch("".concat(i,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c,email:r,password:d})}),t=await e.json();e.ok?(localStorage.setItem("token",t.token),a(t.token,t.company)):j(t.error||"Registration failed")}catch(e){j("Connection error. Please try again.")}p(!1)};return(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h2",{style:{marginBottom:"24px",textAlign:"center"},children:"Create Company Account"}),(0,n.jsxs)("form",{onSubmit:g,children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Company Name"}),(0,n.jsx)("input",{type:"text",value:c,onChange:e=>l(e.target.value),required:!0,disabled:v})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Email"}),(0,n.jsx)("input",{type:"email",value:r,onChange:e=>o(e.target.value),required:!0,disabled:v})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Password"}),(0,n.jsx)("input",{type:"password",value:d,onChange:e=>u(e.target.value),required:!0,disabled:v})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Confirm Password"}),(0,n.jsx)("input",{type:"password",value:h,onChange:e=>m(e.target.value),required:!0,disabled:v})]}),(0,n.jsx)("button",{type:"submit",className:"btn",style:{width:"100%"},disabled:v,children:v?"Creating Account...":"Create Account"}),x&&(0,n.jsx)("div",{className:"error",children:x}),(0,n.jsxs)("div",{className:"small",children:["Already have an account?"," ",(0,n.jsx)("button",{type:"button",className:"link-button",onClick:t,children:"Sign in here"})]})]})]})}function r(e){let{token:a,company:t,onLogout:c}=e,[l,r]=(0,s.useState)("actions"),[d,u]=(0,s.useState)([]),[h,m]=(0,s.useState)([]),[x,j]=(0,s.useState)(!1),[v,p]=(0,s.useState)(null),[g,N]=(0,s.useState)(!1),[b,y]=(0,s.useState)({name:"",value:"",description:""});(0,s.useEffect)(()=>{f(),C()},[]);let f=async()=>{j(!0);try{let e=await fetch("".concat(i,"/meta"),{headers:{Authorization:"Bearer ".concat(a)}}),t=await e.json();e.ok&&u(t.actions||[])}catch(e){console.error("Failed to fetch actions:",e)}j(!1)},C=async()=>{try{let e=await fetch("".concat(i,"/transactions"),{headers:{Authorization:"Bearer ".concat(a)}}),t=await e.json();e.ok&&m(t.transactions||[])}catch(e){console.error("Failed to fetch transactions:",e)}},S=async(e,t)=>{try{let n=await fetch("".concat(i,"/actions/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)});n.ok&&(await f(),p(null))}catch(e){console.error("Failed to update action:",e)}},w=async e=>{try{let t=await fetch("".concat(i,"/actions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(e)});t.ok&&(await f(),N(!1),y({name:"",value:"",description:""}))}catch(e){console.error("Failed to create action:",e)}},k=async e=>{if(confirm("Are you sure you want to delete this action?"))try{let t=await fetch("".concat(i,"/actions/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}});t.ok&&await f()}catch(e){console.error("Failed to delete action:",e)}};return(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"header",children:[(0,n.jsx)("h1",{children:"Play'd Partner Portal"}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,n.jsxs)("span",{children:["Welcome, ",null==t?void 0:t.name,"!"]}),(0,n.jsx)("button",{className:"logout-btn",onClick:c,children:"Logout"})]})]}),(0,n.jsxs)("div",{className:"tabs",children:[(0,n.jsx)("button",{className:"tab ".concat("actions"===l?"active":""),onClick:()=>r("actions"),children:"Recent Transactions"}),(0,n.jsx)("button",{className:"tab ".concat("transactions"===l?"active":""),onClick:()=>r("transactions"),children:"Recent Action Changes"})]}),"actions"===l&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"section-header",children:(0,n.jsx)("h2",{className:"section-title",children:"Company Actions & Values"})}),(0,n.jsxs)("p",{className:"welcome-text",children:["Welcome, ",null==t?void 0:t.name,"! Manage your reward actions and their dollar values below."]}),g&&(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Create New Action"}),(0,n.jsxs)("div",{className:"form-grid",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Name"}),(0,n.jsx)("input",{type:"text",value:b.name,onChange:e=>y({...b,name:e.target.value})})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Value ($)"}),(0,n.jsx)("input",{type:"text",value:b.value,onChange:e=>y({...b,value:e.target.value})})]}),(0,n.jsxs)("div",{className:"form-group full-width",children:[(0,n.jsx)("label",{children:"Description"}),(0,n.jsx)("textarea",{value:b.description,onChange:e=>y({...b,description:e.target.value}),rows:"2"})]})]}),(0,n.jsxs)("div",{className:"form-actions",children:[(0,n.jsx)("button",{className:"btn",onClick:()=>w(b),disabled:!b.name||!b.value,children:"Create Action"}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>{N(!1),y({name:"",value:"",description:""})},children:"Cancel"})]})]}),x?(0,n.jsx)("div",{className:"loading",children:"Loading actions..."}):(0,n.jsxs)("div",{className:"actions-table",children:[(0,n.jsxs)("div",{className:"table-header",children:[(0,n.jsx)("div",{children:"ACTION"}),(0,n.jsx)("div",{children:"VALUE (USD)"}),(0,n.jsx)("div",{children:"DESCRIPTION"}),(0,n.jsx)("div",{children:"ACTIONS"})]}),d.map(e=>(0,n.jsx)("div",{className:"table-row",children:v===e.id?(0,n.jsx)(o,{action:e,onSave:a=>S(e.id,a),onCancel:()=>p(null)}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"action-name",children:e.name}),(0,n.jsxs)("div",{className:"action-value",children:["$",e.value]}),(0,n.jsx)("div",{className:"action-description",children:e.description}),(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:()=>p(e.id),children:"Edit"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:()=>k(e.id),children:"Delete"})]})]})},e.id))]}),(0,n.jsx)("button",{className:"add-action-btn",onClick:()=>N(!0),children:"+ Add New Action"})]}),"transactions"===l&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"section-header",children:(0,n.jsx)("h2",{className:"section-title",children:"User Reward Transactions"})}),0===h.length?(0,n.jsx)("div",{className:"no-data",children:(0,n.jsx)("p",{children:"No transactions yet. Submit some actions to see them here!"})}):(0,n.jsxs)("div",{className:"transactions-table",children:[(0,n.jsxs)("div",{className:"table-header",children:[(0,n.jsx)("div",{children:"USER"}),(0,n.jsx)("div",{children:"ACTION"}),(0,n.jsx)("div",{children:"VALUE"}),(0,n.jsx)("div",{children:"WHEN"})]}),h.map(e=>(0,n.jsxs)("div",{className:"table-row",children:[(0,n.jsx)("div",{className:"transaction-user",children:e.user}),(0,n.jsx)("div",{className:"transaction-action",children:e.actionName}),(0,n.jsxs)("div",{className:"transaction-value",children:["$",e.value]}),(0,n.jsx)("div",{className:"transaction-date",children:new Date(e.timestamp).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]},e.id))]})]})]})}function o(e){let{action:a,onSave:t,onCancel:i}=e,[c,l]=(0,s.useState)(a.name),[r,o]=(0,s.useState)(a.value),[d,u]=(0,s.useState)(a.description);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Name"}),(0,n.jsx)("input",{type:"text",value:c,onChange:e=>l(e.target.value)})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Value ($)"}),(0,n.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value)})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Description"}),(0,n.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),rows:"2"})]}),(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsx)("button",{className:"btn",onClick:()=>{t({name:c,value:r,description:d})},children:"Save"}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:i,children:"Cancel"})]})]})}function d(){let[e,a]=(0,s.useState)(null),[t,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=localStorage.getItem("token");e&&a(e)},[]),e)?(0,n.jsx)(r,{token:e,company:t,onLogout:()=>{localStorage.removeItem("token"),a(null),i(null),d(!1)}}):(0,n.jsx)("div",{className:"auth-container",children:o?(0,n.jsx)(l,{onRegister:(e,t)=>{a(e),i(t),d(!1)},switchToLogin:()=>d(!1)}):(0,n.jsx)(c,{onLogin:(e,t)=>{a(e),i(t),d(!1)},switchToRegister:()=>d(!0)})})}},1163:function(e,a,t){t(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);